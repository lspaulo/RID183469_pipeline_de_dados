[2025-05-20T23:01:19.069+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pipeline_dados.process_bronze_to_silver manual__2025-05-20T23:00:49.244566+00:00 [queued]>
[2025-05-20T23:01:19.082+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pipeline_dados.process_bronze_to_silver manual__2025-05-20T23:00:49.244566+00:00 [queued]>
[2025-05-20T23:01:19.083+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2025-05-20T23:01:19.222+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): process_bronze_to_silver> on 2025-05-20 23:00:49.244566+00:00
[2025-05-20T23:01:19.235+0000] {standard_task_runner.py:57} INFO - Started process 56 to run task
[2025-05-20T23:01:19.247+0000] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'pipeline_dados', 'process_bronze_to_silver', 'manual__2025-05-20T23:00:49.244566+00:00', '--job-id', '47', '--raw', '--subdir', 'DAGS_FOLDER/dag_pipeline_dados.py', '--cfg-path', '/tmp/tmph2nhc2iz']
[2025-05-20T23:01:19.250+0000] {standard_task_runner.py:85} INFO - Job 47: Subtask process_bronze_to_silver
[2025-05-20T23:01:19.464+0000] {task_command.py:415} INFO - Running <TaskInstance: pipeline_dados.process_bronze_to_silver manual__2025-05-20T23:00:49.244566+00:00 [running]> on host 3041e8c3efe8
[2025-05-20T23:01:20.792+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='pipeline_dados' AIRFLOW_CTX_TASK_ID='process_bronze_to_silver' AIRFLOW_CTX_EXECUTION_DATE='2025-05-20T23:00:49.244566+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-20T23:00:49.244566+00:00'
[2025-05-20T23:01:20.794+0000] {dag_pipeline_dados.py:87} INFO - üì• Carregando dados da camada Bronze...
[2025-05-20T23:01:21.125+0000] {dag_pipeline_dados.py:89} INFO - ‚úÖ Dados carregados | Registros: 99999
[2025-05-20T23:01:21.132+0000] {dag_pipeline_dados.py:90} INFO - üîç Amostra dos dados brutos:
|    |   id | name        | email                  | date_of_birth   | signup_date   | subscription_status   |
|---:|-----:|:------------|:-----------------------|:----------------|:--------------|:----------------------|
|  0 |    1 | John Doe    | john.doe@example.com   | 1985-01-15      | 2020-11-01    | active                |
|  1 |    2 | Jane Smith  | jane.smith@example.com | 1990-05-22      | 2019-06-17    | active                |
|  2 |    3 | Bob Johnson | bob.johnson@example    | 1977-03-30      | 2018-12-12    | inactive              |
[2025-05-20T23:01:21.132+0000] {dag_pipeline_dados.py:93} INFO - üßπ Removendo registros com valores nulos...
[2025-05-20T23:01:21.178+0000] {dag_pipeline_dados.py:95} INFO - üìä Registros ap√≥s limpeza: 42196 (removidos: 57803)
[2025-05-20T23:01:21.179+0000] {dag_pipeline_dados.py:98} INFO - ‚úâÔ∏è Corrigindo formatos de email...
[2025-05-20T23:01:21.204+0000] {dag_pipeline_dados.py:100} INFO - üîß Emails a corrigir: 21293
[2025-05-20T23:01:21.250+0000] {logging_mixin.py:151} WARNING - /opt/airflow/dags/dag_pipeline_dados.py:102 SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
[2025-05-20T23:01:21.259+0000] {dag_pipeline_dados.py:105} INFO - üì© Amostra de emails corrigidos:
|    | email                       |
|---:|:----------------------------|
| 10 | williamscharles@example.net |
| 12 | beckermichael@example.net   |
| 17 | wrightlisa@example.net      |
[2025-05-20T23:01:21.259+0000] {dag_pipeline_dados.py:109} INFO - üìÖ Convertendo datas de nascimento...
[2025-05-20T23:01:21.288+0000] {logging_mixin.py:151} WARNING - /opt/airflow/dags/dag_pipeline_dados.py:110 SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
[2025-05-20T23:01:21.289+0000] {dag_pipeline_dados.py:112} INFO - ‚ö†Ô∏è Datas inv√°lidas detectadas: 0
[2025-05-20T23:01:21.309+0000] {dag_pipeline_dados.py:115} INFO - üóìÔ∏è Registros ap√≥s filtro de datas: 42196
[2025-05-20T23:01:21.309+0000] {dag_pipeline_dados.py:118} INFO - üßÆ Calculando idades...
[2025-05-20T23:01:21.589+0000] {dag_pipeline_dados.py:123} INFO - üìä Distribui√ß√£o de idades:
|       |        age |
|:------|-----------:|
| count | 42196      |
| mean  |    54.8795 |
| std   |    21.082  |
| min   |    18      |
| 25%   |    37      |
| 50%   |    55      |
| 75%   |    73      |
| max   |    91      |
[2025-05-20T23:01:22.030+0000] {dag_pipeline_dados.py:129} INFO - üíæ Dados salvos na Silver | Registros: 42196
[2025-05-20T23:01:22.031+0000] {dag_pipeline_dados.py:130} INFO - üìÅ Local: /opt/airflow/data/silver/dados_silver.csv
[2025-05-20T23:01:22.036+0000] {dag_pipeline_dados.py:131} INFO - üîé Amostra final:
|    |   id | name        | email                  | date_of_birth       | signup_date   | subscription_status   |   age |
|---:|-----:|:------------|:-----------------------|:--------------------|:--------------|:----------------------|------:|
|  0 |    1 | John Doe    | john.doe@example.com   | 1985-01-15 00:00:00 | 2020-11-01    | active                |    40 |
|  1 |    2 | Jane Smith  | jane.smith@example.com | 1990-05-22 00:00:00 | 2019-06-17    | active                |    34 |
|  2 |    3 | Bob Johnson | bob.johnson@example    | 1977-03-30 00:00:00 | 2018-12-12    | inactive              |    48 |
[2025-05-20T23:01:22.058+0000] {python.py:194} INFO - Done. Returned value was: None
[2025-05-20T23:01:22.072+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=pipeline_dados, task_id=process_bronze_to_silver, execution_date=20250520T230049, start_date=20250520T230119, end_date=20250520T230122
[2025-05-20T23:01:22.365+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-05-20T23:01:22.406+0000] {taskinstance.py:2784} INFO - 1 downstream tasks scheduled from follow-on schedule check
